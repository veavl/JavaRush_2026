# Дублирование иконок на панели задач Windows

## Вопрос

Почему при запуске Excel через ярлык на рабочем столе на панели задач создается отдельная иконка, хотя программа уже закреплена на панели?

## Пояснение

### Причина

Windows использует AppUserModelID (AUMID) для идентификации и группировки приложений. Если закрепленный ярлык и ярлык на рабочем столе имеют разные метаданные или пути, Windows может присвоить им разные AUMID и воспринимать их как разные экземпляры приложения, даже если они запускают один и тот же .exe файл.

### Аналогия с программированием

Как в Java: разные ссылки на один объект, но Windows их видит как разные объекты, потому что использует AppUserModelID для идентификации, а не просто путь к .exe.

- Закрепленный ярлык → один AUMID
- Ярлык с рабочего стола → другой AUMID (или разные метаданные)
- Windows считает их разными "объектами", хотя запускают один .exe

### Это недоработка?

Частично да — Windows могла бы лучше распознавать одно и то же приложение. Но это также следствие того, как система обрабатывает разные источники запуска (закрепленный ярлык, ярлык на рабочем столе, файл из Проводника и т.д.).

## Решения

1. **Открывать программу через закрепленный ярлык** — самый простой способ.
2. **Пересоздать закрепление:**
   - Открепите программу с панели задач (ПКМ → "Открепить от панели задач")
   - Запустите через ярлык с рабочего стола
   - После запуска закрепите её снова с панели задач (ПКМ на иконке → "Закрепить на панели задач")
3. **Удалить дублирующий ярлык с рабочего стола**, если он не нужен.
4. **Использовать один ярлык** — либо на рабочем столе, либо на панели задач, но не оба.

После пересоздания закрепления обе точки входа должны использовать одну иконку на панели задач.

## Аналогия в Java

```java
String s1 = new String("Excel");
String s2 = new String("Excel");

// s1 != s2 (разные объекты в памяти)
// s1.equals(s2) == true (одинаковое содержимое)
```

Windows в данном случае сравнивает как `s1 != s2`, хотя могла бы проверять "содержимое" (т.е. один и тот же .exe файл).

